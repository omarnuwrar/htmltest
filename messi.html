<!DOCTYPE html>
<!-- Last Published: Sun Jan 30 2022 14:01:56 GMT+0000 (Coordinated Universal Time) -->
<html data-wf-domain="glslslider.webflow.io" data-wf-page="61f5b8a969041077221417b4" data-wf-site="61f5b8a969041046e71417b3">

<head>
    <meta charset="utf-8" />
    <title>GLSL Slider</title>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <link href="https://assets.website-files.com/61f5b8a969041046e71417b3/css/glslslider.be1a2531d.min.css" rel="stylesheet" type="text/css" />
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
    <script type="text/javascript">
        WebFont.load({
            google: {
                families: ["Playfair Display:regular,500,600,700"]
            }
        });
    </script>
    <!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif]-->
    <script type="text/javascript">
        ! function(o, c) {
            var n = c.documentElement,
                t = " w-mod-";
            n.className += t + "js", ("ontouchstart" in o || o.DocumentTouch && c instanceof DocumentTouch) && (n.className += t + "touch")
        }(window, document);
    </script>
    <link href="https://assets.website-files.com/img/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <link href="https://assets.website-files.com/img/webclip.png" rel="apple-touch-icon" />
</head>

<body class="body">
    <div class="next"><img src="https://assets.website-files.com/61f5b8a969041046e71417b3/61f5be55de781d442f2ee17c__next-arrow.svg" loading="lazy" alt="" /></div>
    <div class="prev"><img src="https://assets.website-files.com/61f5b8a969041046e71417b3/61f5be557f80ef31b0166dc3__prev-arrow.svg" loading="lazy" alt="" /></div>
    <div class="description">1 / 6</div>
    <div class="title">Omar Gallary</div><a href="https://codepen.io/theresasogunle/pen/rNGZXWX" target="_blank" class="source">Source</a>
    <div class="canvas-holder w-embed"><canvas> </canvas></div>
    <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=61f5b8a969041046e71417b3" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <!--[if lte IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif]-->
    <script src="https://cdn.jsdelivr.net/npm/glslCanvas@0.1.7/dist/GlslCanvas.min.js"></script>

    <script>
        const includes = `
#ifdef GL_ES
precision mediump float;
#endif
#define NUM_OCTAVES 5
float rand(vec2 n) { 
    return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);
}

float noise(vec2 p){
    vec2 ip = floor(p);
    vec2 u = fract(p);
    u = u*u*(3.0-2.0*u);
    
    float res = mix(
        mix(rand(ip),rand(ip+vec2(1.0,0.0)),u.x),
        mix(rand(ip+vec2(0.0,1.0)),rand(ip+vec2(1.0,1.0)),u.x),u.y);
    return res*res;
}

float fbm(vec2 x) {
    float v = 0.0;
    float a = 0.5;
    vec2 shift = vec2(100);
    // Rotate to reduce axial bias
    mat2 rot = mat2(cos(0.5), sin(0.5), -sin(0.5), cos(0.50));
    for (int i = 0; i < NUM_OCTAVES; ++i) {
        v += a * noise(x);
        x = rot * x * 2.0 + shift;
        a *= 0.5;
    }
    return v;
}
`;

        const frag = (items) => {
            const ifLoop = items
                .map((item, index) => {
                    return `
  if(index == ${index}) {
  return texture2D(textures[${index}], uv);
  }
`;
                })
                .join("else");

            return `
#define MAX ${items.length}
#ifdef GL_ES
precision mediump float;
#endif

uniform float u_time;
uniform vec2 u_resolution;
uniform float timeline;

uniform sampler2D textures[MAX];


uniform float startIndex;
uniform float endIndex;

varying vec3 v_normal;
varying vec2 v_texcoord;

${includes}

vec4 sampleColor(int index, vec2 uv){
 ${ifLoop}
 
}

void main(void)
{
    vec2 uv =  v_texcoord;
    float wave =  fbm(3.5 * uv + 0.2*u_time);
    float strength = smoothstep(0.0, 2.0, timeline)- smoothstep(3.0, 5.0, timeline);
    float distortion = mix(1.0,1.0 + strength,wave);
    uv -= 0.5;
    uv *= distortion;
    uv += 0.5;
    
    if(uv.x < 0.0 || uv.x > 1.0 || uv.y > 1.0 || uv.y < 0.0){
     discard;
    }
    
    // pick images
    vec4 startTexture = sampleColor(int(startIndex), uv);
    vec4 endTexture = sampleColor(int(endIndex), uv);
    
    float changeTimeline = smoothstep(2.0, 3.0,timeline);
    float mixer = 1.0 - step(changeTimeline, wave);
    
    
    vec4 color = mix(startTexture,endTexture, mixer);
    
    gl_FragColor = color;
}
`;
        };

        const paintings = [{
                src: "https://th.bing.com/th/id/OIP.6ppNmnv4CJM4QcLVqyFP-AHaIT?o=7rm=3&rs=1&pid=ImgDetMain&o=7&rm=3",
                title: "1 / 6"
            },
            {
                src: "https://th.bing.com/th/id/OIP.OkdjrdP3qVyn91-WUt96lwHaLH?o=7rm=3&rs=1&pid=ImgDetMain&o=7&rm=3",
                title: "2 / 6"
            },
            {
                src: "https://th.bing.com/th/id/OIP.1_ljtCZ3Rtnyw9X7J14TAAHaLK?o=7rm=3&rs=1&pid=ImgDetMain&o=7&rm=3",
                title: "3 / 6"
            },
            {
                src: "https://ts4.explicit.bing.net/th?id=OIP.jFD2sEwSvc7dzkpe7tcxFQHaIJ&pid=15.1",
                title: "4 / 6"
            },
            {
                src: "https://th.bing.com/th/id/OIP.WqnllNCEn5LE3ohJATIvIQHaEK?o=7rm=3&rs=1&pid=ImgDetMain&o=7&rm=3",
                title: "5 / 6"
            },
            {
                src: "https://tse4.mm.bing.net/th/id/OIP.Hpo51JlkPqZCOkGGdNanswHaHa?rs=1&pid=ImgDetMain&o=7&rm=3",
                title: "6 / 6"
            }
        ];

        const prevTag = document.querySelector(".prev");

        const nextTag = document.querySelector(".next");

        const descriptionTag = document.querySelector(".description");

        const canvas = document.querySelector(".canvas-holder canvas");

        const sandbox = new GlslCanvas(canvas);
        sandbox.load(frag(paintings));

        let startIndex = 0;
        let endIndex = 0;
        let timeline = performance.now() - 9999;

        const sizer = () => {
            const ww = window.innerWidth;
            const wh = window.innerHeight;

            const s = Math.min(ww, wh);
            const dpi = window.devicePixelRatio;

            canvas.width = s * 0.6 * dpi;
            canvas.height = s * 0.9 * dpi;

            canvas.style.width = s * 0.6 + "px";
            canvas.style.height = s * 0.9 + "px";
        };

        const update = () => {
            descriptionTag.innerHTML = paintings[endIndex].title;
            sandbox.setUniform("startIndex", startIndex);
            sandbox.setUniform("endIndex", endIndex);
            timeline = performance.now();

            startIndex = endIndex;
            tick();
        };

        const tick = () => {
            const diff = (performance.now() - timeline) / 400;
            sandbox.setUniform("timeline", diff);
            requestAnimationFrame(tick);
        };

        const load = () => {
            sizer();
            tick();
            paintings.forEach((painting, index) => {
                sandbox.setUniform(`textures[${index}]`, painting.src);
            });
        };

        load();
        const next = () => {
            endIndex = endIndex + 1;
            if (endIndex > paintings.length) {
                endIndex = 0;
            }
            update();
        };

        const prev = () => {
            endIndex = endIndex - 1;
            if (endIndex < 0) {
                endIndex = paintings.length - 1;
            }
            update();
        };

        // events

        window.addEventListener("resize", sizer);

        nextTag.addEventListener("click", (event) => {
            event.preventDefault();
            next();
        });

        prevTag.addEventListener("click", (event) => {
            event.preventDefault();
            prev();
        });
    </script>
</body>

</html>
